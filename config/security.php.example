<?php
/**
 * Security Configuration Example
 * Copy this file to security.php and update the settings for your environment
 * IMPORTANT: Change all default keys and passwords in production!
 */

return [
    // Encryption Settings
    'encryption' => [
        'key' => 'change-this-key-in-production-32-chars', // Must be 32 characters for AES-256
        'cipher' => 'AES-256-CBC',
        'hash_algorithm' => 'sha256'
    ],

    // CSRF Protection
    'csrf' => [
        'enabled' => true,
        'token_name' => 'csrf_token',
        'token_length' => 32,
        'regenerate' => true,
        'lifetime' => 3600 // 1 hour
    ],

    // Password Security
    'password' => [
        'min_length' => 8,
        'require_uppercase' => true,
        'require_lowercase' => true,
        'require_numbers' => true,
        'require_symbols' => false,
        'hash_algorithm' => PASSWORD_ARGON2ID,
        'hash_options' => [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]
    ],

    // Session Security
    'session' => [
        'secure' => false, // Set to true for HTTPS
        'httponly' => true,
        'samesite' => 'Lax',
        'regenerate_frequency' => 300, // 5 minutes
        'max_lifetime' => 7200 // 2 hours
    ],

    // Rate Limiting
    'rate_limiting' => [
        'enabled' => true,
        'max_requests' => 100,
        'time_window' => 3600, // 1 hour
        'block_duration' => 900 // 15 minutes
    ],

    // Security Headers
    'headers' => [
        'hsts' => [
            'enabled' => true,
            'max_age' => 31536000, // 1 year
            'include_subdomains' => true,
            'preload' => false
        ],
        'csp' => [
            'enabled' => true,
            'default_src' => "'self'",
            'script_src' => "'self' 'unsafe-inline'",
            'style_src' => "'self' 'unsafe-inline'",
            'img_src' => "'self' data: https:",
            'font_src' => "'self' https:"
        ],
        'x_frame_options' => 'SAMEORIGIN',
        'x_content_type_options' => 'nosniff',
        'referrer_policy' => 'strict-origin-when-cross-origin'
    ],

    // Authentication
    'auth' => [
        'max_login_attempts' => 5,
        'lockout_duration' => 900, // 15 minutes
        'remember_me_duration' => 604800, // 7 days
        'password_reset_expiry' => 3600 // 1 hour
    ],

    // Input Validation
    'validation' => [
        'sanitize_input' => true,
        'allow_html_tags' => [], // Array of allowed HTML tags
        'max_input_length' => 10000,
        'max_file_uploads' => 20
    ],

    // Security Monitoring
    'monitoring' => [
        'log_suspicious_activity' => true,
        'log_failed_logins' => true,
        'alert_on_suspicious' => false,
        'alert_email' => '' // Email address for security alerts
    ]
];